# PolySurge 项目深度分析报告

## 1. 项目概述

**PolySurge** 是一个针对 Polymarket 预测市场的实时异常信号监控系统（"异动雷达"）。它的核心目标是通过算法自动监控高流动性市场，识别出异常的交易行为（如大额交易、成交量飙升等），帮助用户发现潜在的市场机会。

**核心价值：**
- **实时监控**：每30秒分析100个高流动性市场。
- **智能识别**：自动检测5种关键异常模式。
- **量化评分**：通过多维度评分系统评估信号强度。
- **信号验证**：追踪信号后的价格走势，验证算法有效性。

---

## 2. 核心功能实现

### 2.1 异常检测算法 (Anomaly Detection)

项目通过 `backtest_full.py` (Python回测) 和 `dashboard/app.js` (JS实时) 实现了相同的核心检测逻辑。系统定义了 5 种关键异常类型：

| 异常类型 | 代码标识 | 检测标准 | 权重 |
|---------|---------|---------|------|
| **成交量飙升** | `volume_spike` | 当前窗口总成交量 > 历史中位数 × 5 | 12 |
| **大额交易** | `whale_trade` | 单笔交易额 > 历史中位数 × 20 | 15 |
| **价格异动** | `price_move` | 价格波动幅度 > 10% | 10 |
| **买卖失衡** | `imbalance` | 单边交易占比 > 85% (且总成交量足够) | 8 |
| **高频交易** | `high_frequency` | 5分钟窗口内交易笔数 > 10 | 5 |

**检测窗口**：默认使用 **5分钟** (`window_sec = 300`) 的滑动窗口进行统计分析。

### 2.2 智能评分系统 (Scoring System)

系统不仅仅是检测异常，还通过一个评分模型 (0-100分) 来量化异常的强度。

**评分公式逻辑：**
$$ \text{总分} = \sum(\text{异常类型权重}) + \text{叠加奖励} + \text{强度加分} + \text{流动性加分} $$

- **叠加奖励**：同时出现多种异常（如"大额交易" + "价格异动"）会获得额外加分 (+5~10分)。
- **强度加分**：
    - 成交量倍数越高，加分越多 (最高+20)。
    - 单笔交易规模越大，加分越多 (最高+15)。
    - 价格波动越剧烈，加分越多 (最高+10)。
    - 买卖失衡越严重，加分越多 (最高+10)。
- **流动性加分**：高流动性市场的信号被认为更有价值，给予额外加分。

**信号分级：**
- 🔴 **强信号 (≥70分)**：强烈建议关注。
- 🟡 **中等信号 (40-69分)**：值得关注。
- ⚪ **弱信号 (<40分)**：仅供参考。

### 2.3 信号验证 (Signal Verification)

系统包含一个自我验证机制，用于评估信号的质量：
- **追踪机制**：记录异常发生时的价格。
- **验证逻辑**：检查信号发生后 5 分钟（或30分钟）的价格变化。
- **判断标准**：
    - 如果是买入主导信号且价格上涨 -> ✅ 正确
    - 如果是卖出主导信号且价格下跌 -> ✅ 正确
    - 否则 -> ❌ 错误

---

## 3. 技术架构

### 3.1 前端 (Dashboard)
- **路径**：`dashboard/`
- **技术栈**：原生 HTML/JS + Tailwind CSS (CDN) + Chart.js。
- **核心文件**：
    - `index.html`: UI 结构，包含实时事件流、排行榜、统计面板。
    - `app.js`: 核心逻辑。负责数据获取、异常检测计算、UI渲染、通知推送。
    - **特点**：前端直接进行异常检测计算（"胖前端"模式），减轻了后端压力，实现了分布式的实时计算。

### 3.2 后端/服务层
- **路径**：`dashboard/server.py`
- **功能**：
    - 一个轻量级的 Python HTTP 服务器。
    - **API 代理**：转发请求到 `data-api.polymarket.com` 和 `gamma-api.polymarket.com`，解决浏览器直接访问 Polymarket API 的 CORS (跨域) 问题。
    - 提供静态文件服务。

### 3.3 数据源
- **Gamma API** (`gamma-api.polymarket.com`): 获取市场列表、元数据、流动性信息。
- **Data API** (`data-api.polymarket.com`): 获取实时成交记录 (Trades)。

---

## 4. 项目文件结构分析

```text
polysurge/
├── README.md               # 项目文档
├── backtest_full.py        # Python回测脚本，用于验证算法和历史数据分析
├── backtest_analysis.py    # 回测结果分析工具
├── dashboard/              # Web 仪表盘目录
│   ├── index.html          # 主界面
│   ├── app.js              # 前端核心逻辑 (含异常检测算法的JS实现)
│   ├── server.py           # 本地代理服务器 (Python)
│   ├── start.sh            # 启动脚本
│   └── vercel.json         # Vercel 部署配置
└── ...
```

## 5. 总结

PolySurge 是一个**轻量级但功能完整**的加密预测市场监控工具。它巧妙地利用了前端计算能力，配合简单的代理服务器，实现了复杂的实时异常检测。其核心竞争力在于**多维度的异常评分算法**和**可视化的实时数据面板**，能够帮助交易者快速从海量市场数据中筛选出有价值的交易机会。
